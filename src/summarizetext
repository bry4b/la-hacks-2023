import openai_secret_manager
import openai
import utils.constants as ct


#assert "openai" in openai_secret_manager.get_services()
#secrets = openai_secret_manager.get_secret("openai")

openai.api_key = ct.OPENAI_API_KEY#secrets[ct.OPENAI_API_KEY]

def clean_text(transcript):
    transcript = "Clean the following text: \" " + transcript + " \""
    response = openai.Completion.create(
        engine="text-davinci-002",
        prompt=transcript,
        max_tokens=60,
        n=1,
        stop=None,
        temperature=0.7,
    )
    # Print the response
    return response.choices[0].text.strip()

def generate_bullet_point(transcript):
    transcript = clean_text(transcript)
    transcript = "Summarize the following so that it can be used as a review resource for students. " + \
    "You may use headings, nested bullet points, etc. \" " + transcript + " \""
    response = openai.Completion.create(
        engine="text-davinci-002",
        prompt=transcript,
        max_tokens=60,
        n=1,
        stop=None,
        temperature=0.7,
    )
    # Print the response
    return response.choices[0].text.strip()

